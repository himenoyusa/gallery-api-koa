# 1. 图片展示网站接口文档

> 目录

<!-- TOC -->

- [1. 图片展示网站接口文档](#1-图片展示网站接口文档)
  - [1.1. 错误代码查询](#11-错误代码查询)
  - [1.2. 用户模块](#12-用户模块)
    - [1.2.1. 查询所有用户](#121-查询所有用户)
    - [1.2.2. 查询用户资料](#122-查询用户资料)
    - [1.2.3. 用户登录](#123-用户登录)
    - [1.2.4. 用户注册](#124-用户注册)
    - [1.2.5. 修改用户资料](#125-修改用户资料)
    - [1.2.6. 查询用户关注](#126-查询用户关注)
    - [1.2.7. 查询用户粉丝](#127-查询用户粉丝)
    - [1.2.8. 关注用户](#128-关注用户)
    - [1.2.9. 取消关注](#129-取消关注)
  - [1.3. 图片模块](#13-图片模块)
    - [1.3.1. 查询指定方式排序的缩略图](#131-查询指定方式排序的缩略图)
    - [1.3.2. 查询单张图片完整信息](#132-查询单张图片完整信息)
    - [1.3.3. 修改图片](#133-修改图片)
    - [1.3.4. 上传图片](#134-上传图片)
    - [1.3.5. 删除图片](#135-删除图片)
    - [1.3.6. 为图片评分](#136-为图片评分)
    - [1.3.7. 删除图片评分](#137-删除图片评分)
    - [1.3.8. 为图片添加 tag](#138-为图片添加-tag)
    - [1.3.9. 删除图片 tag](#139-删除图片-tag)

<!-- /TOC -->

---

## 1.1. 错误代码查询

| 代码 | 含义         |
| ---- | ------------ |
| 200  | 请求成功     |
| 204  | 操作成功     |
| 400  | 请求失败     |
| 401  | 认证未通过   |
| 403  | 禁止访问     |
| 404  | 资源不存在   |
| 409  | 请求冲突     |
| 422  | 请求参数错误 |
| 500  | 服务器错误   |

## 1.2. 用户模块

### 1.2.1. 查询所有用户

> GET /api/users

Query string

| 参数     | 必选  | 类型 | 说明         |
| -------- | ----- | ---- | ------------ |
| page     | false | int  | 页码         |
| per_page | false | int  | 每页获取数量 |

Response

```json
Status: 200 OK
--------------
[
    {
        "gender": "男",
        "verified": true,
        "level": "guest",
        "_id": "5f38943ac174910658455e7d",
        "name": "yusa",
        "headline": "It's the only NEET thing to do"
    }
]
```

### 1.2.2. 查询用户资料

> GET /api/users/:id

params

| 参数   | 必选  | 类型   | 说明         |
| ------ | ----- | ------ | ------------ |
| id     | true  | string | 用户 id      |
| fields | false | array  | 输出额外信息 |

Response

```json
Status: 200 OK
--------------
{
    "gender": "男",
    "verified": false,
    "level": "guest",
    "_id": "5f38943ac174910658575e7d",
    "name": "yusa",
    "headline": "its the only neet thing to do"
}
```

```json
Status: 404 Not Found
{
    "message": "用户不存在",
    "name": "NotFoundError",
    "status": 404
}
```

### 1.2.3. 用户登录

> POST /api/users/login

Parameters

| 参数     | 必选 | 类型   | 说明 |
| -------- | ---- | ------ | ---- |
| name     | true | string | 账号 |
| password | true | string | 密码 |

Example

```json
{
  "name": "sena",
  "password": "123"
}
```

Response

```json
Status: 200 OK
--------------
{
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IdpXVCJ9.eyJfaWQiOiI1ZjM5ZTkyZGZmODJlZDNhYjQ0Yjg1NGEiLCJuYW1lIjoic2VuYSIsImxldmVsIjoiYWRtaW4iLCJpYXQiOjE1OTc3MTcsNTIsImV4cCI6MTU5NzgwMzY1Mn0.cAiR9DJCM7BlVQALShHT2OaSZijLgTxoNxMSe42ChxU"
}
```

```json
Status: 401 Unauthorized
------------------------
{
    "message": "用户名或密码不正确",
    "name": "UnauthorizedError",
    "status": 401
}
```

```json
Status: 422 Unprocessable Entity
--------------------------------
{
    "message": "Validation Failed",
    "errors": [
        {
            "message": "required",
            "field": "name",
            "code": "missing_field"
        }
    ],
    "params": {
        "password": "123"
    }
}
```

### 1.2.4. 用户注册

> POST /api/users

Parameters

| 参数     | 必选 | 类型   | 说明 |
| -------- | ---- | ------ | ---- |
| name     | true | string | 账号 |
| password | true | string | 密码 |

Example

```json
{
  "name": "sena",
  "password": "123"
}
```

Response

```json
Status: 204 No Content
----------------------
```

```json
Status: 422 Unprocessable Entity
--------------------------------
{
    "message": "Validation Failed",
    "errors": [
        {
            "message": "required",
            "field": "name",
            "code": "missing_field"
        }
    ],
    "params": {
        "password": "123"
    }
}
```

### 1.2.5. 修改用户资料

> PATCH /api/users/:id

Parameters

| 参数       | 必选  | 类型                       | 说明 |
| ---------- | ----- | -------------------------- | ---- |
| name       | false | string                     | 账号 |
| password   | false | string                     | 密码 |
| avatar_url | false | string                     | 头像 |
| gender     | false | enum: ["男", "女", "其他"] | 性别 |
| headline   | false | string                     | 简介 |
| age        | false | number                     | 年龄 |
| locations  | false | string                     | 地区 |
| business   | false | string                     | 职业 |

Example

```json
{
  "name": "sena2",
  "password": "1234",
  "avatar_url": "https://localhost/upload/123.jpg",
  "gender": "男",
  "headline": "Yes this is me",
  "age": 18,
  "locations": "tokyo",
  "business": "programing"
}
```

Response

```json
Status: 204 No Content
----------------------
```

```json
Status: 422 Unprocessable Entity
--------------------------------
{
    "message": "Validation Failed",
    "errors": [
        {
            "message": "should be a number",
            "code": "invalid",
            "field": "age"
        }
    ],
    "params": {
        "age": "123"
    }
}
```

### 1.2.6. 查询用户关注

> GET /api/users/:id/following

params

| 参数 | 必选 | 类型   | 说明    |
| ---- | ---- | ------ | ------- |
| id   | true | string | 用户 id |

Response

```json
Status: 200 OK
--------------
[
   {
        "gender": "男",
        "verified": true,
        "level": "guest",
        "_id": "5f38943ac174910348575e7d",
        "name": "yusa",
        "headline": "its the only neet thing to do"
    }
]

```

### 1.2.7. 查询用户粉丝

> GET /api/users/:id/followers

params

| 参数 | 必选 | 类型   | 说明    |
| ---- | ---- | ------ | ------- |
| id   | true | string | 用户 id |

Response

```json
Status: 200 OK
--------------
[
   {
        "gender": "男",
        "verified": true,
        "level": "guest",
        "_id": "5f38943ac112310348575e7d",
        "name": "yusa2"
    }
]

```

### 1.2.8. 关注用户

> PUT /api/users/following/:id

params

| 参数 | 必选 | 类型   | 说明    |
| ---- | ---- | ------ | ------- |
| id   | true | string | 用户 id |

Response

```json
Status: 204 No Content
--------------
```

### 1.2.9. 取消关注

> DELETE /api/users/following/:id

params

| 参数 | 必选 | 类型   | 说明    |
| ---- | ---- | ------ | ------- |
| id   | true | string | 用户 id |

Response

```json
Status: 204 No Content
--------------
```

## 1.3. 图片模块

### 1.3.1. 查询指定方式排序的缩略图

> GET /api/pictures

Query string

| 参数     | 必选  | 类型 | 说明         |
| -------- | ----- | ---- | ------------ |
| page     | false | int  | 页码         |
| per_page | false | int  | 每页获取数量 |

Response

```json
Status: 200 OK
--------------
[
  {
    "total_score": 0,
    "limit": false,
    "tags": [],
    "_id": "5f39f6008f11dd3248c2ac37",
    "pic_dir": "http://localhost:3001/uploads/upload_094be97850c52103c2f2602a681f84dd.png",
    "thumb_dir": "http://localhost:3001/uploads/upload_c9e492db53821c9208605c2adfef256e.png",
    "created_by": "5f39e92dff82ed3ab44b854a"
  },
  {
    "total_score": 0,
    "limit": false,
    "tags": [],
    "_id": "5f39f939f33a9609f0406e4f",
    "pic_dir": "http://localhost:3001/uploads/upload_fcf5c8f724d615cacc696aa8d40f6e1d.png",
    "thumb_dir": "http://localhost:3001/uploads/upload_9dc6eb4526a9f93e3991d610d4503cee.png",
    "created_by": "5f39e92dff82ed3ab44b854a"
  }
]
```

### 1.3.2. 查询单张图片完整信息

> GET /api/pictures/:id

Parameters

| 参数 | 必选 | 类型   | 说明    |
| ---- | ---- | ------ | ------- |
| id   | true | string | 图片 id |

Response

```json
Status: 200 OK
--------------
{
    "total_score": 0,
    "limit": false,
    "tags": [],
    "_id": "5f39f4f02d270d1834a1b703",
    "pic_dir": "upload_df6d94ff8f38745d97abb8bc13646d8a.png",
    "thumb_dir": "upload_b2f3b8673434b4a67a29d60e9b0172d1.png",
    "created_by": "5f39e92dff82ed3ab44b854a"
}
```

```json
Status: 404 Not Found
---------------------
{
    "message": "图片不存在",
    "name": "NotFoundError",
    "status": 404
}
```

### 1.3.3. 修改图片

### 1.3.4. 上传图片

> POST /api/pictures

Parameters

| 参数        | 必选 | 类型 | 说明       |
| ----------- | ---- | ---- | ---------- |
| uploadPic   | true | file | 图片文件   |
| uploadThumb | true | file | 缩略图文件 |

Response

```json
Status: 200 OK
--------------
{
    "total_score": 0,
    "limit": false,
    "tags": [],
    "_id": "5f3b44abfc51c51c80e43f13",
    "pic_dir": "http://localhost:3001/uploads/upload_b782ac6f2c9f8959cf7e0e8fef201bf3.png",
    "thumb_dir": "http://localhost:3001/uploads/upload_cdf8e26237bb152a14fe42b9cb2b7848.png",
    "created_by": "5f39e92dff82ed3ab44b854a",
    "__v": 0
}
```

### 1.3.5. 删除图片

### 1.3.6. 为图片评分

### 1.3.7. 删除图片评分

### 1.3.8. 为图片添加 tag

### 1.3.9. 删除图片 tag
